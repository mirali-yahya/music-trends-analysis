<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sophie Pöll">
<meta name="author" content="Mirali Yahyayev">
<meta name="author" content="Oleg Kushnir">
<meta name="author" content="Aysegul Polat">
<meta name="dcterms.date" content="2025-02-28">

<title>Internationalization of the Music Industry</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="template_files/libs/clipboard/clipboard.min.js"></script>
<script src="template_files/libs/quarto-html/quarto.js"></script>
<script src="template_files/libs/quarto-html/popper.min.js"></script>
<script src="template_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="template_files/libs/quarto-html/anchor.min.js"></script>
<link href="template_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="template_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="template_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="template_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="template_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="template_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="template_files/libs/pagedtable-1.1/js/pagedtable.js"></script>



</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#theoretical-background" id="toc-theoretical-background" class="nav-link active" data-scroll-target="#theoretical-background">Theoretical Background</a>
  <ul class="collapse">
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research Questions</a></li>
  </ul></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a>
  <ul class="collapse">
  <li><a href="#biggest-songs-of-each-country" id="toc-biggest-songs-of-each-country" class="nav-link" data-scroll-target="#biggest-songs-of-each-country">Biggest songs of each country</a></li>
  <li><a href="#most-globally-streamed-song-each-week" id="toc-most-globally-streamed-song-each-week" class="nav-link" data-scroll-target="#most-globally-streamed-song-each-week">Most Globally Streamed Song Each Week</a></li>
  <li><a href="#global-top-200-ranked" id="toc-global-top-200-ranked" class="nav-link" data-scroll-target="#global-top-200-ranked">Global Top 200 ranked</a></li>
  <li><a href="#where-the-track-first-appeared" id="toc-where-the-track-first-appeared" class="nav-link" data-scroll-target="#where-the-track-first-appeared">Where the track first appeared</a></li>
  <li><a href="#average-days-to-go-global" id="toc-average-days-to-go-global" class="nav-link" data-scroll-target="#average-days-to-go-global">Average Days To Go Global</a></li>
  <li><a href="#closeness-centrality" id="toc-closeness-centrality" class="nav-link" data-scroll-target="#closeness-centrality">Closeness Centrality</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Internationalization of the Music Industry</h1>
<p class="subtitle lead">Analysis of musical trends’ flow from national charts to global charts</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Sophie Pöll </p>
             <p>Mirali Yahyayev </p>
             <p>Oleg Kushnir </p>
             <p>Aysegul Polat </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 28, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="theoretical-background" class="level1">
<h1>Theoretical Background</h1>
<p>It is evident, the global music industry has experienced an unprecedented transformation in the last years. While the rise of streaming services and broadband internet have made it harder for emerging artists to break through or for labels to establish new talent, they have also made it easier for countries to share and access each other’s (local) music (<span class="citation" data-cites="Way_Garcia-Gathright_Cramer_2020">Way, Garcia-Gathright, and Cramer (<a href="#ref-Way_Garcia-Gathright_Cramer_2020" role="doc-biblioref">2020</a>)</span>). Historically, the United States have been the dominant exporter of cultural products, especially music, since World War II (<span class="citation" data-cites="Kim_2021">J. Kim (<a href="#ref-Kim_2021" role="doc-biblioref">2021</a>)</span>). However, this trend is shifting. The share of English-language tracks in the Top 10K global tracks declined from 62.1% to 54.9% in just one year in 2023. U.S. listeners are increasingly engaging with non-English content, with the share of Spanish-language streaming in the U.S. rising to over 8%, up from 3.9% in 2021.</p>
<p>Latin music, in particular, has been one of the fastest-growing genres in the U.S., with on-demand audio streams increasing by 24.1% in 2023 (<span class="citation" data-cites="Luminate_2024"><span>“Top Entertainment Trends for 2024: What the Data Says, as Presented at SXSW”</span> (<a href="#ref-Luminate_2024" role="doc-biblioref">2024</a>)</span>). Latin music has thus become a key segment of North American consumption, creating a cycle that drives further growth in this region while fostering their local, authentic music culture (<span class="citation" data-cites="IFPI_2024"><span>“Global Music Report 2024: State of the Industry”</span> (<a href="#ref-IFPI_2024" role="doc-biblioref">2024</a>)</span>).</p>
<p>Similarly, the consumption of Korean-language music has also seen a growth (<span class="citation" data-cites="Luminate_2024"><span>“Top Entertainment Trends for 2024: What the Data Says, as Presented at SXSW”</span> (<a href="#ref-Luminate_2024" role="doc-biblioref">2024</a>)</span>). Historically, South Korea was a significant importer of global music, but it has now transformed into a major exporter, especially with the global rise of K-Pop. Beginning with Wonder Girls’ “Nobody” entering the Billboard Hot 100 in 2009 and Psy’s “Gangnam Style” in 2012, the first YouTube video to reach one billion views, K-Pop has steadily gained international prominence (<span class="citation" data-cites="Kim_2023">B. Kim and Kang (<a href="#ref-Kim_2023" role="doc-biblioref">2023</a>)</span>). Today, K-Pop consistently appears in global charts, with six K-Pop artists / groups featured in the Global Artist Chart Top 20 in 2024.</p>
<p>Countries like India and China also show significant potential for global music expansion. With India’s vast, youthful population, the country is becoming an increasingly influential player in global pop culture. Similarly, China is investing in building its local talent pool and improving A&amp;R capabilities, positioning itself to have a major impact on the global music scene (<span class="citation" data-cites="IFPI_2024"><span>“Global Music Report 2024: State of the Industry”</span> (<a href="#ref-IFPI_2024" role="doc-biblioref">2024</a>)</span>).</p>
<section id="research-questions" class="level2">
<h2 class="anchored" data-anchor-id="research-questions">Research Questions</h2>
<p>There is limited research on identifying and quantifying which countries are the primary sources of influence in global music trends and how music from these countries reaches global charts. Experts suggest that regions like Latin America, Southeast Asia, and South Korea are becoming key drivers of global music consumption, but empirical evidence to support these claims, particularly in terms of their specific impact on global charts, remains scarce.</p>
<p>There is a need for more in-depth analysis of the flow of musical trends from national charts to global charts, and how regional influences shape the global music landscape. Therefore, this research aims to answer the following questions:</p>
<ul>
<li><p>RQ1. Which countries dominate the music industry based on streaming volume?</p></li>
<li><p>RQ2. Which countries most frequently contribute songs to the global and other national charts?</p></li>
<li><p>RQ3. Which countries are most central to the flow of music?</p></li>
</ul>
</section>
</section>
<section id="analysis" class="level1">
<h1>Analysis</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(arrow)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="do">### Weekly Top 200 2024</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>top200 <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"C:/Users/HP Pavilion/Downloads/weekly_top_200_2024.parquet"</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># top200 &lt;- read_parquet(file.choose())  # You can remove this if you're already specifying the file path</span></span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="do">### Songs Meta 2024</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_parquet</span>(<span class="st">"C:/Users/HP Pavilion/Downloads/song_meta_2024.parquet"</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># meta &lt;- read_parquet(file.choose())  # Same as above, no need for file.choose() if you have a path</span></span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co"># Ensure the 'week_date' column is in Date format (from 'top200' dataset)</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>top200<span class="sc">$</span>week_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(top200<span class="sc">$</span>week_date)</span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co"># Ensure the 'release_date' column is in Date format (from 'meta' dataset)</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>meta<span class="sc">$</span>release_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(meta<span class="sc">$</span>release_date)</span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co"># Full join the datasets by 'track_id'</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>bigset <span class="ot">&lt;-</span> <span class="fu">full_join</span>(top200, meta, <span class="at">by =</span> <span class="st">"track_id"</span>)</span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="co"># Check the first few rows to ensure the merge was successful</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="fu">head</span>(bigset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["track_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["week_date"],"name":[2],"type":["date"],"align":["right"]},{"label":["country"],"name":[3],"type":["chr"],"align":["left"]},{"label":["streams"],"name":[4],"type":["int"],"align":["right"]},{"label":["rank"],"name":[5],"type":["int"],"align":["right"]},{"label":["track_name"],"name":[6],"type":["chr"],"align":["left"]},{"label":["release_date"],"name":[7],"type":["date"],"align":["right"]},{"label":["label"],"name":[8],"type":["chr"],"align":["left"]},{"label":["total_streams"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"0R6NfOiLzLj4O5VbYSJAjf","2":"2024-01-05","3":"GLOBAL","4":"34195950","5":"1","6":"La Diabla","7":"2023-11-30","8":"Interscope Records","9":"1210763400"},{"1":"3rUGC1vUpkDG9CZFHMur1t","2":"2024-01-05","3":"GLOBAL","4":"34059012","5":"2","6":"greedy","7":"2023-09-15","8":"RCA Records Label","9":"1775199198"},{"1":"4xhsWYTOGcal8zt0J161CU","2":"2024-01-05","3":"GLOBAL","4":"32055608","5":"3","6":"Lovin On Me","7":"2023-11-10","8":"Generation Now/Atlantic","9":"876906284"},{"1":"1BxfuPKGuaTgP7aM0Bbdwr","2":"2024-01-05","3":"GLOBAL","4":"28511866","5":"4","6":"Cruel Summer","7":"2019-08-23","8":"Taylor Swift","9":"2055808419"},{"1":"7CyPwkp0oE8Ro9Dd5CUDjW","2":"2024-01-05","3":"GLOBAL","4":"27400991","5":"5","6":"One Of The Girls (with JENNIE, Lily Rose Depp)","7":"2023-06-23","8":"XO / Republic Records","9":"1742106823"},{"1":"3vkCueOmm7xQDoJ17W1Pm3","2":"2024-01-05","3":"GLOBAL","4":"27354041","5":"6","6":"My Love Mine All Mine","7":"2023-09-15","8":"Dead Oceans","9":"1605871332"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Let’s see which countries are in our dataset</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># List the unique countries in the 'country' column</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>unique_countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(bigset<span class="sc">$</span>country)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># View the list of unique countries</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>unique_countries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "GLOBAL" "IT"     "JP"     "LT"     "LU"     "MY"     "MX"     "NL"    
 [9] "NZ"     "NI"     "NO"     "PA"     "PY"     "IE"     "PE"     "PL"    
[17] "PT"     "SG"     "SK"     "ES"     "SE"     "CH"     "TW"     "TR"    
[25] "GB"     "UY"     "US"     "PH"     "ID"     "LV"     "IS"     "AR"    
[33] "AU"     "AT"     "BE"     "BO"     "BR"     "BG"     "CA"     "CL"    
[41] "CO"     "CR"     "DK"     "DO"     "EC"     "CZ"     "HU"     "SV"    
[49] "EE"     "FI"     "HK"     "GT"     "FR"     "HN"     "DE"     "GR"    
[57] "TH"     "IL"     "VN"     "RO"     "ZA"     "IN"     "SA"     "AE"    
[65] "MA"     "EG"     "UA"     "KR"     "KZ"     "NG"     "BY"     "VE"    
[73] "PK"    </code></pre>
</div>
</div>
<p>Now, we can explore which countries are biggest music markets</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Calculate total streams per country</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>country_streams <span class="ot">&lt;-</span> bigset<span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">summarise</span>(<span class="at">total_streams =</span> <span class="fu">sum</span>(streams, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_streams))</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># Display the ranked list of countries based on total streams</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>ranked_countries <span class="ot">&lt;-</span> country_streams</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># Print the ranked list</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="fu">print</span>(ranked_countries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 73 × 2
   country total_streams
   &lt;chr&gt;           &lt;dbl&gt;
 1 GLOBAL   150185253434
 2 US        43731133113
 3 MX        28841315110
 4 BR        24143632402
 5 ID        20084042056
 6 IN        18920201227
 7 PH        13666606125
 8 DE        10057188577
 9 TR         9987584160
10 GB         9765639616
# ℹ 63 more rows</code></pre>
</div>
</div>
<p>We can show this table in histogram for top 10 countries (There will be 11 data because “Global” is counted as 1st place. So, we will show dataset for top 10 countries plus “Global”. So, 11 in total)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>top11_countries <span class="ot">&lt;-</span> country_streams <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">top_n</span>(<span class="dv">11</span>, total_streams)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">ggplot</span>(top11_countries, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, total_streams), <span class="at">y =</span> total_streams <span class="sc">/</span> <span class="fl">1e6</span>, <span class="at">fill =</span> <span class="fu">ifelse</span>(total_streams <span class="sc">==</span> <span class="fu">max</span>(total_streams), <span class="st">"red"</span>, <span class="st">"grey"</span>))) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"grey"</span> <span class="ot">=</span> <span class="st">"grey"</span>)) <span class="sc">+</span>  <span class="co"># Define colors</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(top11_countries<span class="sc">$</span>total_streams) <span class="sc">/</span> <span class="fl">1e6</span>, <span class="at">by =</span> <span class="dv">10000</span>)) <span class="sc">+</span>  <span class="co"># Add ticks every 10M</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries (incl. Global) by Total Streams"</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>       <span class="at">y =</span> <span class="st">"Total Streams (in Millions)"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="co"># Remove legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="template_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we see, US has the biggest portion in the world music industry. Total streams in US is approximately 15.000 higher than total streams of the second top country, Mexico.</p>
<section id="biggest-songs-of-each-country" class="level2">
<h2 class="anchored" data-anchor-id="biggest-songs-of-each-country">Biggest songs of each country</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>top11_country_songs <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> top11_countries<span class="sc">$</span>country) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">group_by</span>(country, track_name) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">summarise</span>(<span class="at">total_streams =</span> <span class="fu">sum</span>(streams, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">arrange</span>(country, <span class="fu">desc</span>(total_streams)) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co"># Print the list of most streamed songs in the top 10 countries</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="fu">print</span>(top11_country_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
   country track_name                   total_streams
   &lt;chr&gt;   &lt;chr&gt;                                &lt;int&gt;
 1 BR      THE BOX MEDLEY FUNK 2            189296016
 2 DE      Wunder                           103866261
 3 ES      Si Antes Te Hubiera Conocido     122831133
 4 GB      Stick Season                     143286443
 5 GLOBAL  BIRDS OF A FEATHER              1796520740
 6 ID      Satu Bulan                       241376819
 7 IN      Pehle Bhi Main                   246460629
 8 MX      Madonna                          408843914
 9 PH      sining (feat. Jay R)             181785226
10 TR      CISTAK                           131198021
11 US      Espresso                         467061222</code></pre>
</div>
</div>
<p>Histogram for the most streamed song in each top country</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(top11_country_songs, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, total_streams), <span class="at">y =</span> total_streams <span class="sc">/</span> <span class="fl">1e6</span>, <span class="at">fill =</span> track_name)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(total_streams <span class="sc">/</span> <span class="fl">1e6</span>, <span class="dv">1</span>)),  <span class="co"># Add labels showing total streams</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,  <span class="co"># Position text above bars</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>            <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span>  <span class="co"># Adjust text size</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(top11_country_songs<span class="sc">$</span>total_streams) <span class="sc">/</span> <span class="fl">1e6</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span>  <span class="co"># Set y-axis scale every 100M</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Most Streamed Songs in Top 10 Countries and Global"</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a>       <span class="at">y =</span> <span class="st">"Total Streams (in Millions)"</span>,  </span>
<span id="cb9-9"><a href="#cb9-9"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,  </span>
<span id="cb9-10"><a href="#cb9-10"></a>       <span class="at">fill =</span> <span class="st">"Track Name"</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  </span>
<span id="cb9-13"><a href="#cb9-13"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="template_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As it is shown in the chart, the most popular song in US market has been streamed significantly more than other popular songs in the top countries</p>
</section>
<section id="most-globally-streamed-song-each-week" class="level2">
<h2 class="anchored" data-anchor-id="most-globally-streamed-song-each-week">Most Globally Streamed Song Each Week</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>top_songs_each_week <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"GLOBAL"</span>, rank <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">group_by</span>(week_date) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">select</span>(<span class="sc">-</span>rank, <span class="sc">-</span>track_id, <span class="sc">-</span>week_date, <span class="sc">-</span>release_date, <span class="sc">-</span>streams, <span class="sc">-</span>total_streams)</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a>top_songs_each_week</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["week_date"],"name":[1],"type":["date"],"align":["right"]},{"label":["country"],"name":[2],"type":["chr"],"align":["left"]},{"label":["track_name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["label"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"2024-01-05","2":"GLOBAL","3":"La Diabla","4":"Interscope Records"},{"1":"2023-12-29","2":"GLOBAL","3":"greedy","4":"RCA Records Label"},{"1":"2024-05-17","2":"GLOBAL","3":"MILLION DOLLAR BABY","4":"ISO Supremacy. Under exclusive license to PULSE Records."},{"1":"2024-05-24","2":"GLOBAL","3":"LUNCH","4":"Darkroom/Interscope Records"},{"1":"2024-05-31","2":"GLOBAL","3":"Espresso","4":"Island Records"},{"1":"2024-12-13","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-12-06","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-10-11","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-10-18","2":"GLOBAL","3":"APT.","4":"Atlantic Records"},{"1":"2024-12-20","2":"GLOBAL","3":"All I Want for Christmas Is You","4":"Columbia"},{"1":"2024-12-27","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-10-25","2":"GLOBAL","3":"APT.","4":"Atlantic Records"},{"1":"2024-01-19","2":"GLOBAL","3":"La Diabla","4":"Interscope Records"},{"1":"2024-01-26","2":"GLOBAL","3":"La Diabla","4":"Interscope Records"},{"1":"2024-05-10","2":"GLOBAL","3":"MILLION DOLLAR BABY","4":"ISO Supremacy. Under exclusive license to PULSE Records."},{"1":"2024-02-02","2":"GLOBAL","3":"La Diabla","4":"Interscope Records"},{"1":"2024-02-09","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-02-16","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-06-07","2":"GLOBAL","3":"Espresso","4":"Island Records"},{"1":"2024-06-14","2":"GLOBAL","3":"Please Please Please","4":"Island Records"},{"1":"2024-11-01","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-11-08","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-11-15","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-01-12","2":"GLOBAL","3":"yes, and?","4":"Republic Records"},{"1":"2024-05-03","2":"GLOBAL","3":"Espresso","4":"Island Records"},{"1":"2025-01-03","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-02-23","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-03-01","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-07-05","2":"GLOBAL","3":"Espresso","4":"Island Records"},{"1":"2024-07-12","2":"GLOBAL","3":"BIRDS OF A FEATHER","4":"Darkroom/Interscope Records"},{"1":"2024-06-21","2":"GLOBAL","3":"Please Please Please","4":"Island Records"},{"1":"2024-11-29","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-03-29","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-04-05","2":"GLOBAL","3":"i like the way you kiss me","4":"Artemas"},{"1":"2024-03-08","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-06-28","2":"GLOBAL","3":"Espresso","4":"Island Records"},{"1":"2024-11-22","2":"GLOBAL","3":"APT.","4":"Atlantic Records"},{"1":"2024-09-20","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-03-15","2":"GLOBAL","3":"we can't be friends (wait for your love)","4":"Republic Records"},{"1":"2024-07-19","2":"GLOBAL","3":"Who","4":"BIGHIT MUSIC"},{"1":"2024-07-26","2":"GLOBAL","3":"Who","4":"BIGHIT MUSIC"},{"1":"2024-08-02","2":"GLOBAL","3":"Who","4":"BIGHIT MUSIC"},{"1":"2024-03-22","2":"GLOBAL","3":"Beautiful Things","4":"Night Street Records, Inc./Warner Records Inc."},{"1":"2024-09-27","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-10-04","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-08-09","2":"GLOBAL","3":"BIRDS OF A FEATHER","4":"Darkroom/Interscope Records"},{"1":"2024-08-16","2":"GLOBAL","3":"BIRDS OF A FEATHER","4":"Darkroom/Interscope Records"},{"1":"2024-04-12","2":"GLOBAL","3":"i like the way you kiss me","4":"Artemas"},{"1":"2024-04-19","2":"GLOBAL","3":"Fortnight (feat. Post Malone)","4":"Taylor Swift"},{"1":"2024-04-26","2":"GLOBAL","3":"Fortnight (feat. Post Malone)","4":"Taylor Swift"},{"1":"2024-08-30","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-09-06","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-09-13","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"},{"1":"2024-08-23","2":"GLOBAL","3":"Die With A Smile","4":"Interscope"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can see the list of Globally top song each week. Now, we can analyze how many weeks these songs have been leader in Global market</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>top_songs_each_week <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">group_by</span>(track_name) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">count</span>(track_name) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["track_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Die With A Smile","2":"16"},{"1":"Beautiful Things","2":"7"},{"1":"Espresso","2":"5"},{"1":"La Diabla","2":"4"},{"1":"APT.","2":"3"},{"1":"BIRDS OF A FEATHER","2":"3"},{"1":"Who","2":"3"},{"1":"Fortnight (feat. Post Malone)","2":"2"},{"1":"MILLION DOLLAR BABY","2":"2"},{"1":"Please Please Please","2":"2"},{"1":"i like the way you kiss me","2":"2"},{"1":"All I Want for Christmas Is You","2":"1"},{"1":"LUNCH","2":"1"},{"1":"greedy","2":"1"},{"1":"we can't be friends (wait for your love)","2":"1"},{"1":"yes, and?","2":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>As shown in the table, most globally popular song has been “Die With A Smile”. However, interesting fact is that this song is not most streamed song according to the result of “Biggest songs of each country”.</p>
</section>
<section id="global-top-200-ranked" class="level2">
<h2 class="anchored" data-anchor-id="global-top-200-ranked">Global Top 200 ranked</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Step 1: Filter for Global songs</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>global_songs <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"GLOBAL"</span>)  <span class="co"># Only select rows where the country is 'GLOBAL'</span></span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># Step 2: Group by track_id and track_name, sum streams, and count weeks in the global charts</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>global_songs_ranked <span class="ot">&lt;-</span> global_songs <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">group_by</span>(track_id, track_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-9"><a href="#cb12-9"></a>    <span class="at">total_streams =</span> <span class="fu">sum</span>(streams, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Sum the streams for each song</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="at">weeks_in_chart =</span> <span class="fu">n_distinct</span>(week_date),  <span class="co"># Count the number of distinct weeks the song was in the chart</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>  <span class="co"># Drop grouping after summarising</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_streams)) <span class="sc">%&gt;%</span> <span class="co"># Sort by total streams in descending order</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="fu">select</span>(<span class="sc">-</span>track_id)</span>
<span id="cb12-15"><a href="#cb12-15"></a></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="fu">print</span> (<span class="at">n=</span><span class="dv">15</span>, global_songs_ranked)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,540 × 3
   track_name                                     total_streams weeks_in_chart
   &lt;chr&gt;                                                  &lt;int&gt;          &lt;int&gt;
 1 BIRDS OF A FEATHER                                1796520740             34
 2 Die With A Smile                                  1455445377             21
 3 Espresso                                          1318147517             24
 4 Lose Control                                      1293557047             54
 5 Beautiful Things                                  1243109891             40
 6 End of Beginning                                  1201325433             47
 7 Cruel Summer                                      1153626261             54
 8 we can't be friends (wait for your love)          1129256633             44
 9 Good Luck, Babe!                                  1118206219             40
10 Who                                               1107403865             25
11 greedy                                            1023362257             54
12 LUNA                                              1004122591             54
13 I Wanna Be Yours                                   998924555             54
14 Not Like Us                                        987073036             36
15 One Of The Girls (with JENNIE, Lily Rose Depp)     980203603             46
# ℹ 1,525 more rows</code></pre>
</div>
</div>
<p>Despite the fact that “Birds of Feather” has been 3 times top song globally, this song has most total streams in 2024. Which means, even though the song has been most streamed song worldwide, the song can be listed top for few weeks. Reason for this is that the song was very popular for few weeks, but later the streams declines fast and the song looses its top performance worldwide.</p>
</section>
<section id="where-the-track-first-appeared" class="level2">
<h2 class="anchored" data-anchor-id="where-the-track-first-appeared">Where the track first appeared</h2>
<p>Now, we can see where was the place the song appeared first before going global.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Step 1: Extract the earliest national chart appearance for each song</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>first_appearance <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">filter</span>(country <span class="sc">!=</span> <span class="st">"GLOBAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">group_by</span>(track_id) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">filter</span>(week_date <span class="sc">==</span> <span class="fu">min</span>(week_date)) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co"># Step 2: Create a list showing the first week and countries where each song appeared</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>first_week_countries <span class="ot">&lt;-</span> first_appearance <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">group_by</span>(track_id, track_name, week_date) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">summarise</span>(<span class="at">countries =</span> <span class="fu">paste</span>(<span class="fu">unique</span>(country), <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co"># Step 3: Filter for songs that later appear in the global chart</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>global_appearance <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"GLOBAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="fu">select</span>(track_id, week_date)</span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co"># Step 4: Join the first appearance with global chart data and filter for valid entries</span></span>
<span id="cb14-20"><a href="#cb14-20"></a>first_to_global <span class="ot">&lt;-</span> first_appearance <span class="sc">%&gt;%</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>  <span class="fu">inner_join</span>(global_appearance, <span class="at">by =</span> <span class="st">"track_id"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_national"</span>, <span class="st">"_global"</span>), <span class="at">relationship =</span> <span class="st">"many-to-many"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22"></a>  <span class="fu">filter</span>(week_date_national <span class="sc">&lt;</span> week_date_global)</span>
<span id="cb14-23"><a href="#cb14-23"></a></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co"># Step 5: Count the frequency of each country being the first to chart a song before it reaches the global charts</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>country_frequency <span class="ot">&lt;-</span> first_to_global <span class="sc">%&gt;%</span></span>
<span id="cb14-26"><a href="#cb14-26"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb14-27"><a href="#cb14-27"></a>  <span class="fu">summarise</span>(<span class="at">frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb14-28"><a href="#cb14-28"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(frequency))</span>
<span id="cb14-29"><a href="#cb14-29"></a></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="co"># Output the ranked list of countries</span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="fu">print</span>(country_frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 2
   country frequency
   &lt;chr&gt;       &lt;int&gt;
 1 CA           6389
 2 US           6178
 3 GB           5965
 4 AE           5943
 5 AU           5870
 6 LV           5586
 7 IE           5559
 8 NZ           5353
 9 CH           5217
10 NO           5126
# ℹ 62 more rows</code></pre>
</div>
</div>
<p>Now, we can visualize the results</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>top_20_countries <span class="ot">&lt;-</span> country_frequency <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">head</span>(<span class="dv">20</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># Create the bar chart with flipped axis</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="fu">ggplot</span>(top_20_countries, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, <span class="sc">-</span>frequency), <span class="at">y =</span> frequency, </span>
<span id="cb16-7"><a href="#cb16-7"></a>                             <span class="at">fill =</span> country <span class="sc">==</span> country[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(top_20_countries<span class="sc">$</span>frequency) <span class="sc">+</span> <span class="dv">500</span>),  <span class="co"># Start y-axis at 3000</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="at">labels =</span> <span class="fu">label_comma</span>()</span>
<span id="cb16-13"><a href="#cb16-13"></a>  ) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'darkgrey'</span>, <span class="st">'red'</span>)) <span class="sc">+</span>  <span class="co"># Highlight the max country</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> frequency), </span>
<span id="cb16-16"><a href="#cb16-16"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb16-17"><a href="#cb16-17"></a>            <span class="at">size =</span> <span class="dv">3</span>, </span>
<span id="cb16-18"><a href="#cb16-18"></a>            <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 20 Countries with the Highest Frequency of Global Hits First Appearing in Their Charts"</span>,</span>
<span id="cb16-20"><a href="#cb16-20"></a>       <span class="at">x =</span> <span class="st">"Country"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb16-24"><a href="#cb16-24"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># Rotate x-axis labels</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb16-26"><a href="#cb16-26"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="template_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the result, we can see that Canada hosts many songs which has been globally popular later. However, it is good to emphasis that this result can be misleading too, since there was a problem with the data set. In the data set, for some songs, the first appeared country is more than one. For example, some songs appear in many countries simultaneously on the day of release. So, it is most probable that some songs appeared in Canada and US at the same time, so each country gets count for this.</p>
</section>
<section id="average-days-to-go-global" class="level2">
<h2 class="anchored" data-anchor-id="average-days-to-go-global">Average Days To Go Global</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>bigset <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">mutate</span>(<span class="at">week_date =</span> <span class="fu">as.Date</span>(week_date),</span>
<span id="cb17-3"><a href="#cb17-3"></a>         <span class="at">release_date =</span> <span class="fu">as.Date</span>(release_date))</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co"># Identify global chart entries</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>global_charts <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"GLOBAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="fu">select</span>(track_id, <span class="at">global_week_date =</span> week_date)</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co"># Merge with original data to find national chart entries</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>national_to_global <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="fu">inner_join</span>(global_charts, <span class="at">by =</span> <span class="st">"track_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="fu">filter</span>(country <span class="sc">!=</span> <span class="st">"GLOBAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="fu">mutate</span>(<span class="at">days_to_global =</span> <span class="fu">as.numeric</span>(global_week_date <span class="sc">-</span> week_date))</span>
<span id="cb17-15"><a href="#cb17-15"></a></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co"># Calculate average time lag for each country</span></span>
<span id="cb17-17"><a href="#cb17-17"></a>country_avg_lag <span class="ot">&lt;-</span> national_to_global <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19"></a>  <span class="fu">summarise</span>(<span class="at">avg_days_to_global =</span> <span class="fu">mean</span>(days_to_global, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>  <span class="fu">arrange</span>(avg_days_to_global)</span>
<span id="cb17-21"><a href="#cb17-21"></a></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="co"># Lollipop chart</span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="co"># Select Top 10, Middle 10, and Bottom 10 countries</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>country_filtered <span class="ot">&lt;-</span> country_avg_lag <span class="sc">%&gt;%</span></span>
<span id="cb17-25"><a href="#cb17-25"></a>  <span class="fu">arrange</span>(avg_days_to_global) <span class="sc">%&gt;%</span></span>
<span id="cb17-26"><a href="#cb17-26"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>  <span class="fu">filter</span>(rank <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">|</span> rank <span class="sc">&gt;</span> (<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">15</span>) <span class="sc">|</span> (rank <span class="sc">&gt;</span> (<span class="fu">n</span>()<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">5</span>) <span class="sc">&amp;</span> rank <span class="sc">&lt;=</span> (<span class="fu">n</span>()<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">5</span>)))</span>
<span id="cb17-28"><a href="#cb17-28"></a></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="co"># Create the lollipop chart</span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="fu">ggplot</span>(country_filtered, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, avg_days_to_global), <span class="at">y =</span> avg_days_to_global, <span class="at">color =</span> avg_days_to_global)) <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> <span class="dv">0</span>, <span class="at">xend =</span> country), <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span>  <span class="co"># Lollipop stick</span></span>
<span id="cb17-32"><a href="#cb17-32"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span>  <span class="co"># Lollipop head</span></span>
<span id="cb17-33"><a href="#cb17-33"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"pink"</span>) <span class="sc">+</span>  <span class="co"># Gradient color</span></span>
<span id="cb17-34"><a href="#cb17-34"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">55</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># Set y-axis breaks every 5 units</span></span>
<span id="cb17-35"><a href="#cb17-35"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Days it takes a Song from National to Global Charts"</span>,</span>
<span id="cb17-36"><a href="#cb17-36"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb17-37"><a href="#cb17-37"></a>       <span class="at">y =</span> <span class="st">"Days on Average"</span>,</span>
<span id="cb17-38"><a href="#cb17-38"></a>       <span class="at">color =</span> <span class="st">"Days to Global"</span>) <span class="sc">+</span></span>
<span id="cb17-39"><a href="#cb17-39"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-40"><a href="#cb17-40"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate x-axis labels for better readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="template_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">print</span>(<span class="at">n=</span><span class="dv">72</span>, country_avg_lag)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 2
   country avg_days_to_global
   &lt;chr&gt;                &lt;dbl&gt;
 1 GT               -27.0    
 2 MX               -18.0    
 3 PY               -15.6    
 4 SV               -14.7    
 5 NI               -13.3    
 6 BO               -13.1    
 7 CO               -12.8    
 8 ES               -12.1    
 9 UY               -12.0    
10 PE               -11.6    
11 HN               -11.5    
12 AR                -9.57   
13 CL                -8.86   
14 CR                -8.85   
15 EC                -8.08   
16 AU                -6.32   
17 DO                -4.33   
18 VE                -3.46   
19 AE                -3.14   
20 SG                -3.13   
21 NZ                -2.78   
22 CH                -2.28   
23 PA                -1.36   
24 GB                -1.16   
25 EE                -0.823  
26 CA                -0.786  
27 BY                -0.00103
28 US                 0.329  
29 IN                 0.529  
30 SA                 0.763  
31 LU                 0.810  
32 BE                 1.02   
33 MY                 1.22   
34 JP                 1.59   
35 KR                 1.61   
36 KZ                 1.86   
37 PT                 1.95   
38 IE                 2.26   
39 LV                 2.58   
40 LT                 2.70   
41 VN                 3.10   
42 TW                 3.26   
43 SE                 3.47   
44 HU                 3.96   
45 HK                 4.10   
46 BG                 4.38   
47 AT                 4.65   
48 TH                 4.85   
49 CZ                 5.08   
50 DE                 5.75   
51 PH                 5.89   
52 NO                 6.12   
53 NL                 7.54   
54 PK                 7.96   
55 SK                 8.30   
56 RO                 9.09   
57 IL                 9.31   
58 BR                 9.86   
59 IS                10.5    
60 FR                11.1    
61 ID                11.1    
62 DK                11.3    
63 UA                11.9    
64 PL                14.0    
65 ZA                14.9    
66 IT                16.4    
67 TR                19.4    
68 FI                19.7    
69 NG                20.7    
70 MA                21.1    
71 GR                22.6    
72 EG                52.0    </code></pre>
</div>
</div>
<p>From the table and lollipop chart, the countries with minus days are the countries which did not produce any global song. So, these countries are represented on the left side of the lollipop chart.</p>
<p>The countries with the highest going global performance are represented in the middle of lollipop chart. According to the table, a song from US takes 0.4 days to be popular in global. This is the top performance in the table.</p>
</section>
<section id="closeness-centrality" class="level2">
<h2 class="anchored" data-anchor-id="closeness-centrality">Closeness Centrality</h2>
<p>Let’s see which country is the most central country in the network</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>first_appearances <span class="ot">&lt;-</span> bigset <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>    <span class="fu">filter</span>(country <span class="sc">!=</span> <span class="st">"GLOBAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>    <span class="fu">group_by</span>(track_id, country) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>    <span class="fu">summarize</span>(<span class="at">first_week =</span> <span class="fu">min</span>(week_date), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a>  </span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="co"># Step 2: Identify country-to-country transitions</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  transitions <span class="ot">&lt;-</span> first_appearances <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>    <span class="fu">group_by</span>(track_id) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="fu">arrange</span>(first_week) <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>    <span class="fu">mutate</span>(<span class="at">next_country =</span> <span class="fu">lead</span>(country)) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(next_country)) <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="fu">count</span>(country, next_country, <span class="at">name =</span> <span class="st">"weight"</span>)</span>
<span id="cb20-14"><a href="#cb20-14"></a>  </span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="co"># Step 3: Build the influence network</span></span>
<span id="cb20-16"><a href="#cb20-16"></a>  g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(transitions, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-17"><a href="#cb20-17"></a>  </span>
<span id="cb20-18"><a href="#cb20-18"></a>  <span class="co"># Step 4: Calculate closeness centrality</span></span>
<span id="cb20-19"><a href="#cb20-19"></a>  closeness_centrality <span class="ot">&lt;-</span> <span class="fu">closeness</span>(g, <span class="at">mode =</span> <span class="st">"out"</span>, <span class="at">normalized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-20"><a href="#cb20-20"></a>  <span class="fu">V</span>(g)<span class="sc">$</span>closeness <span class="ot">&lt;-</span> closeness_centrality</span>
<span id="cb20-21"><a href="#cb20-21"></a></span>
<span id="cb20-22"><a href="#cb20-22"></a>  <span class="co"># Step 4.1: Create a ranked dataframe of closeness centrality scores</span></span>
<span id="cb20-23"><a href="#cb20-23"></a>  closeness_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-24"><a href="#cb20-24"></a>    <span class="at">country =</span> <span class="fu">V</span>(g)<span class="sc">$</span>name,</span>
<span id="cb20-25"><a href="#cb20-25"></a>    <span class="at">closeness =</span> closeness_centrality</span>
<span id="cb20-26"><a href="#cb20-26"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-27"><a href="#cb20-27"></a>    <span class="fu">arrange</span>(closeness) <span class="sc">%&gt;%</span>  <span class="co"># Sort in ascending order</span></span>
<span id="cb20-28"><a href="#cb20-28"></a>    <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">row_number</span>())  <span class="co"># Rank starts at 1 for lowest closeness</span></span>
<span id="cb20-29"><a href="#cb20-29"></a>  </span>
<span id="cb20-30"><a href="#cb20-30"></a>  <span class="co"># View the dataframe</span></span>
<span id="cb20-31"><a href="#cb20-31"></a>  <span class="fu">print</span>(closeness_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   country closeness rank
DE      DE 0.4104046    1
EC      EC 0.4382716    2
GB      GB 0.4437500    3
HU      HU 0.4493671    4
HN      HN 0.4580645    5
MX      MX 0.4580645    6
DO      DO 0.4701987    7
PA      PA 0.4701987    8
CO      CO 0.4733333    9
LV      LV 0.4765101   10
SV      SV 0.4829932   11
BO      BO 0.4863014   12
SE      SE 0.4896552   13
KZ      KZ 0.4930556   14
US      US 0.4965035   15
ES      ES 0.5000000   16
LT      LT 0.5000000   17
NI      NI 0.5000000   18
CA      CA 0.5035461   19
CH      CH 0.5035461   20
DK      DK 0.5035461   21
EG      EG 0.5035461   22
FR      FR 0.5035461   23
GT      GT 0.5035461   24
ID      ID 0.5035461   25
PE      PE 0.5035461   26
IE      IE 0.5071429   27
IS      IS 0.5071429   28
TR      TR 0.5071429   29
ZA      ZA 0.5071429   30
AE      AE 0.5107914   31
EE      EE 0.5107914   32
NO      NO 0.5107914   33
SG      SG 0.5107914   34
AT      AT 0.5144928   35
AU      AU 0.5144928   36
IT      IT 0.5144928   37
NL      NL 0.5144928   38
BG      BG 0.5182482   39
AR      AR 0.5220588   40
CL      CL 0.5220588   41
CZ      CZ 0.5220588   42
NZ      NZ 0.5220588   43
PT      PT 0.5259259   44
PY      PY 0.5259259   45
RO      RO 0.5259259   46
CR      CR 0.5298507   47
KR      KR 0.5298507   48
SK      SK 0.5298507   49
LU      LU 0.5338346   50
IN      IN 0.5378788   51
JP      JP 0.5378788   52
MA      MA 0.5419847   53
PK      PK 0.5419847   54
TH      TH 0.5419847   55
BE      BE 0.5461538   56
PL      PL 0.5461538   57
VN      VN 0.5461538   58
BY      BY 0.5503876   59
NG      NG 0.5503876   60
PH      PH 0.5503876   61
TW      TW 0.5503876   62
UY      UY 0.5503876   63
BR      BR 0.5546875   64
HK      HK 0.5546875   65
SA      SA 0.5546875   66
VE      VE 0.5546875   67
FI      FI 0.5590551   68
GR      GR 0.5590551   69
UA      UA 0.5590551   70
IL      IL 0.5634921   71
MY      MY 0.5680000   72</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co">#Prepare for visualization</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">V</span>(g)<span class="sc">$</span>continent <span class="ot">&lt;-</span> <span class="fu">countrycode</span>(<span class="fu">V</span>(g)<span class="sc">$</span>name, <span class="st">"iso2c"</span>, <span class="st">"continent"</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">V</span>(g)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">V</span>(g)<span class="sc">$</span>closeness <span class="sc">*</span> <span class="dv">10</span>  <span class="co"># Node size based on influence</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">V</span>(g)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(g)<span class="sc">$</span>closeness <span class="sc">==</span> <span class="fu">min</span>(<span class="fu">V</span>(g)<span class="sc">$</span>closeness), <span class="st">"red"</span>, <span class="st">"black"</span>)  <span class="co"># Red outline for most influential</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  </span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="co">#Visualize the network</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">ggraph</span>(g, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>    <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight, <span class="at">color =</span> weight), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  <span class="co"># Edge color based on weight</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>    <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> size, <span class="at">color =</span> continent)) <span class="sc">+</span>  <span class="co"># Fully colored nodes</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>    <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Ensure text is readable</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>    <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>    <span class="fu">scale_edge_color_gradient</span>(<span class="at">low =</span> <span class="st">"lightgrey"</span>, <span class="at">high =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Gradient from grey to black</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>    <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb22-16"><a href="#cb22-16"></a>  </span>
<span id="cb22-17"><a href="#cb22-17"></a>   <span class="fu">theme_void</span>() <span class="sc">+</span>  </span>
<span id="cb22-18"><a href="#cb22-18"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Global Music Network"</span>,</span>
<span id="cb22-19"><a href="#cb22-19"></a>         <span class="at">subtitle =</span> <span class="st">"Tracking the spread of hit songs across countries based on first chart appearances"</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>    <span class="fu">theme</span>(</span>
<span id="cb22-21"><a href="#cb22-21"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb22-22"><a href="#cb22-22"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb22-23"><a href="#cb22-23"></a>      <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="template_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>According to the graph analysis of the “Closeness Centrality” chart, Germany emerges as the most influential country in the global music network with the highest centrality (0.4104046), followed by Ecuador and Great Britain. This indicates that songs from these countries spread most efficiently throughout the global music ecosystem. Countries with higher values like Switzerland (ranked 20th) have less influence in the global music diffusion network.</p>
</section>
</section>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-IFPI_2024" class="csl-entry" role="listitem">
<span>“Global Music Report 2024: State of the Industry.”</span> 2024. <a href="https://ifpi-website-cms.s3.eu-west- 2.amazonaws.com/IFPI_GMR_2024_State_of_the_Industry_db92a1c9c1.pdf">https://ifpi-website-cms.s3.eu-west- 2.amazonaws.com/IFPI_GMR_2024_State_of_the_Industry_db92a1c9c1.pdf</a>.
</div>
<div id="ref-Kim_2023" class="csl-entry" role="listitem">
Kim, Byeongsik, and Byeongwoo Kang. 2023. <span>“K-Pop’s Internationalization in the Product Adaptation and the Upstream Music Supply Chain in Korea, China, Japan, and the West.”</span> <em>Asia Pacific Business Review</em> 29 (5): 1369–93. <a href="https://doi.org/10.1080/13602381.2023.2230156">https://doi.org/10.1080/13602381.2023.2230156</a>.
</div>
<div id="ref-Kim_2021" class="csl-entry" role="listitem">
Kim, Jaehyun. 2021. <span>“Music Popularity Prediction Through Data Analysis of Music’s Characteristics.”</span> <em>International Journal of Science, Technology and Society</em> 9 (5): 239–44. <a href="https://doi.org/10.11648/j.ijsts.20210905.16">https://doi.org/10.11648/j.ijsts.20210905.16</a>.
</div>
<div id="ref-Luminate_2024" class="csl-entry" role="listitem">
<span>“Top Entertainment Trends for 2024: What the Data Says, as Presented at SXSW.”</span> 2024. <a href="https://luminatedata.com/reports/sxsw-top-entertainment-trends-for-2024/">https://luminatedata.com/reports/sxsw-top-entertainment-trends-for-2024/</a>.
</div>
<div id="ref-Way_Garcia-Gathright_Cramer_2020" class="csl-entry" role="listitem">
Way, Samuel F., Jean Garcia-Gathright, and Henriette Cramer. 2020. <span>“Local Trends in Global Music Streaming.”</span> <em>Proceedings of the International AAAI Conference on Web and Social Media</em>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>